{% extends "lucyDJ/base.html" %}
{% load calcfilters %}
{% block content %}
<h1> Беспорядочная куча мусора от работы модели</h1>

<form action="" method="get">

    <div class="parameters">

        {% for field in form%}
        <div class="parameter">
            {{ field.label_tag }}
            {{ field }}
        </div>
        {% endfor %}

        {% for field in cform%}
        <div class="parameter">
            {{ field.label_tag }}
            {{ field }}
        </div>
        {% endfor %}

        <div class="parameter">
            <input type=submit value='Load data'> </input>
        </div>

    </div>

</form>

<div class="rubberblock" style="top: 54.75%">
    <div class="rubberblock-inner">
        <table>
            <thead>
                <tr>
                    {% for key in lines|first %}
                    <td> {{ key }} </td>
                    {% endfor %}
                </tr>
            </thead>
            {% for line in lines %}
            <tr>
                {% for key, value in line.items %}
                <td> {{ value }} </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
    </div>
</div>


<script>
$(function () {
    $('#container').highcharts({
        chart: {
            type: 'scatter',
            zoomType: 'xy'
        },
        title: {
            text: 'XY GRAPH'
        },
        xAxis: {
            title: {
                text: "{{ graph_x }}"
            }
        },
        yAxis: {
            title: {
                text: "{{ graph_y }}"
            }
        },
        plotOptions: {
            scatter: {
                marker: {
                    radius: 1.0
                },
                color: '#fa0000',
                lineWidth: 0.5
            }
        },
        series: [{
            name: 'Data pull',
            data:
                [{% for line in lines|dictsort:graph_x %}
                    [
                    {% for key, value in line.items %}
                        {% if key == graph_x %}
                            {{ value }}
                        {% endif %}
                    {% endfor %},

                    {% for key, value in line.items %}
                        {% if key == graph_y %}
                            {{ value }}
                        {% endif %}
                    {% endfor %}
                    ],
            {% endfor %}]
        }]
    });
});
</script>

<div id="container" class="rubberblock"> </div>

{% endblock %}

