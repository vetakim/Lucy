{% extends "lucyDJ/base.html" %}
{% load calcfilters %}
{% block content %}
<h1> Беспорядочная куча мусора от работы модели</h1>

<form action="" method="get">
    <div class="parameters">
        {% for field in form%}
        {{ field }}
        <label style="top: {{ forloop.counter|mul:20|add:-10 }}%"> {{ field.label }}</label>
        {% endfor %}
    </div>
    <div class="calcclear">
        {% for field in cform%}
        {{ field }}
        <label style="top: {{ forloop.counter|mul:5 }}%"> {{ field.label }}</label>
        {% endfor %}
        <input type=submit style="top: 25%" value='Load data'> </input>
    </div>
</form>

<div class="rubberblock" style="top: 53.75%">
    <div class="rubberblock-inner">
        <table>
            <thead>
                <tr>
                    {% for key in lines|first %}
                    <td> {{ key }} </td>
                    {% endfor %}
                </tr>
            </thead>
            {% for line in lines %}
            <tr>
                {% for key, value in line.items %}
                <td> {{ value }} </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
    </div>
</div>


<script>
$(function () {
    $('#container').highcharts({
        chart: {
            type: 'scatter',
            zoomType: 'xy'
        },
        title: {
            text: 'TEST GRAPH'
        },
        xAxis: {
            title: {
                text: 'ordinate'
            }
        },
        yAxis: {
            title: {
                text: 'abscissa'
            }
        },
        plotOptions: {
            scatter: {
                marker: {
                    radius: 1.0
                },
                color: '#fa0000',
                lineWidth: 0.5
            }
        },
        series: [{
            name: 'Data pull',
            data:
                [{% for line in lines|dictsort:"id"%}
                    [
                    {% for key, value in line.items %}
                        {% if key == graph_x %}
                            {{ value }}
                        {% endif %}
                    {% endfor %},

                    {% for key, value in line.items %}
                        {% if key == graph_y %}
                            {{ value }}
                        {% endif %}
                    {% endfor %}
                    ],
            {% endfor %}]
        }]
    });
});
</script>

<div id="container" class="rubberblock"> </div>

{% endblock %}

